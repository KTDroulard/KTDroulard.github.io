
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>A Patch Too Late - Kyle Droulard | Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a-patch-too-late" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Kyle Droulard | Portfolio" class="md-header__button md-logo" aria-label="Kyle Droulard | Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kyle Droulard | Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A Patch Too Late
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Kyle Droulard | Portfolio" class="md-nav__button md-logo" aria-label="Kyle Droulard | Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kyle Droulard | Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attack Analysis
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="a-patch-too-late">A Patch Too Late</h1>
<h1 id="about">About</h1>
<p><strong>Target</strong>: Kioptrix Level 1 (Vuln Hub download: <a href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/">here</a>)</p>
<p><strong>Author:</strong> Kyle Droulard</p>
<h2 id="summary">Summary</h2>
<p>In the early 2000s, services like Apache, Samba, and SSH formed the backbone of web infrastructure. But in their earlier versions, they came with significant vulnerabilities. They serve as critical teaching tools for exploit development, service enumeration, privilege escalation and ultimately the importance of good patch management. </p>
<p><strong>Kioptrix Level 1</strong> proves to be a good study for these vulnerable services. It’s a deliberately vulnerable Linux virtual machine emulating a pre-2005 web stack. This environment provides an understanding of how legacy misconfigurations and poor patch hygiene can give attackers full root access with minimal resistance.</p>
<p>In this write-up, I explore the box from enumeration to exploitation, while reflecting on the legacy of the vulnerabilities that made it possible.</p>
<h2 id="tools-used">Tools Used</h2>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Nmap</td>
<td>Port &amp; service discovery</td>
</tr>
<tr>
<td>Netdiscover</td>
<td>Host discovery</td>
</tr>
<tr>
<td>smbclient</td>
<td>SMB enumeration</td>
</tr>
<tr>
<td>Burp Suite</td>
<td>Manual web testing</td>
</tr>
<tr>
<td>Metasploit</td>
<td>Exploitation</td>
</tr>
<tr>
<td>GCC</td>
<td>Compiling custom exploit</td>
</tr>
</tbody>
</table>
<h2 id="initial-discovery">Initial Discovery</h2>
<p>To locate the Kioptrix vm, I used an ARP-based discovery method by sending ARP requests across a CIDR block and identifying devices across the network.</p>
<p><strong>Tool:</strong> <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwim45KTutCOAxUJlGoFHfRdEawQFnoECBkQAQ&amp;url=https%3A%2F%2Fwww.stationx.net%2Fnmap-ping-sweep%2F&amp;usg=AOvVaw3FEqmn2J1D_yUNe-PKZxuW&amp;opi=89978449">nmap ping sweep</a>, or <a href="https://www.hackercoolmagazine.com/beginners-guide-to-netdiscover/?srsltid=AfmBOopGG8It26r71ZGPr0JTNuINpMuvOY0IsTazMXT1PhVmY7qXeMu7">netdiscover</a></p>
<p>Once the IP address is identified we can proceed with the assessment by identifying vulnerable services running on the server with a port scan.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image.png" /></p>
<h2 id="port-enumeration">Port Enumeration</h2>
<p>To identify vulnerable services running on the target we can run a Nmap scan. As Anti Virus is not something that we are worried about here we can run a quick scan.</p>
<p><strong>Command:</strong> <code>nmap -T5 -A &lt;host_ip&gt;</code></p>
<p><strong>Additional Resources:</strong>  <a href="https://www.stationx.net/nmap-cheat-sheet/">Nmap Cheat Sheet</a></p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image1.png" /></p>
<p>From our scans we can observe that the server is running vulnerable versions of SSH, HTTP and SMB. We can proceed investigating by performing Web Enumeration, SMB Enumeration and possible SSH exploits. </p>
<h2 id="web-enumeration">Web Enumeration</h2>
<p>Through web enumeration we will try to discover possible vulnerable endpoints that can provide us attack surfaces. </p>
<p><strong>Tools:</strong> Burp Suite, dirbuster or nikto.</p>
<p><strong>Additional Resources:</strong> </p>
<ul>
<li><a href="https://www.freecodecamp.org/news/an-introduction-to-web-server-scanning-with-nikto/">Nikto</a></li>
<li><a href="https://www.kali.org/tools/dirbuster/">dirbuster | Kali Linux Tools</a></li>
</ul>
<h3 id="findings"><strong>Findings</strong></h3>
<p><strong>Finding:</strong> http[://]192[.]168[.]1[.]107/manual/mod </p>
<p>Our first discovery is a web page that provides Apache modules documentation. Though as no sensitive content is exposed there is no immediate value here so we will take note of it for further inspection, though it appears to be a dead end.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image2.png" /></p>
<p><strong>Finding:</strong> http[://]192[.]168[.]1[.]107/test.php</p>
<p>Our second discovery is a web page that executes PHP on the server. Though as there is no visible injection point this doesn't provide immediate value. So we will take note of this as well, though it also appears to be a dead end.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image3.png" /></p>
<p><strong>Finding:</strong> Information Disclosure vulnerability. </p>
<p>Our third web enumeration finding is an Information Disclosure vulnerability, which provides us that the web application is running Apache 1.3.20. However, we previously discovered that via Nmap so this doesn't provide us immediate value.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image4.png" /></p>
<h2 id="smb-enumeration">SMB Enumeration</h2>
<p>Through performing SMB enumeration we can try to discover unauthenticated access accessible file shares.</p>
<p><strong>Tool:</strong>  <code>smbclient</code> </p>
<p><strong>Findings:</strong> </p>
<ul>
<li><strong>Shares:</strong> IPC$, ADMIN$</li>
<li><strong>Server:</strong> KIOPTRIX</li>
<li><strong>Workgroup:</strong> MYGROUP</li>
</ul>
<p><strong>Outcome:</strong> No exploit path via SMB shares, but version information confirmed possible exploit targets.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image5.png" /></p>
<h2 id="ssh-observations">SSH Observations</h2>
<p>The target runs SSH version 1, which is obsolete and vulnerable to key reuse, replay and downgrade attacks. However in this context brute-force and MiTM attacks are outside of the scope for this study, so we won’t be pursuing this further.</p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image6.png" /></p>
<h1 id="research-exploits">Research Exploits</h1>
<p>After conducting some research we can see that these exposed services are notoriously vulnerable and we can even find some known exploits within GitHub and Metasploit. </p>
<p><strong>Reference:</strong> <a href="http://exploit-db.comhttps://www.exploit-db.com/">exploit-db.com</a></p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Version</th>
<th>CVE</th>
<th>Exploits</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Apache</td>
<td>1.3.20</td>
<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2002-0082">CVE-2002-0082</a></td>
<td>• <a href="https://www.exploit-db.com/exploits/764">ExploitDB Finding</a></td>
<td></td>
</tr>
<tr>
<td>• <a href="https://github.com/heltonWernik/OpenLuck?tab=readme-ov-file">Possible Exploit in GitHub</a></td>
<td>Source code for exploit found here.</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Samba</td>
<td>2.2.1a</td>
<td><a href="https://nvd.nist.gov/vuln/detail/CVE-2003-0201">CVE-2003-0201</a></td>
<td><a href="https://www.exploit-db.com/exploits/10">ExploitDB Finding</a></td>
<td>An exploit could utilize Metasploit</td>
</tr>
<tr>
<td>OpenSSH</td>
<td>2.9p2 (v1)</td>
<td>N/A</td>
<td>N/A</td>
<td>Possible MiTM and Replay Attacks via Key Pair Collision in SSH V1. (More <a href="https://www.cvedetails.com/cve/CVE-2001-1473/">here</a>.)</td>
</tr>
</tbody>
</table>
<h1 id="exploitation">Exploitation</h1>
<p>Samba 2.2.1a has a vulnerability due to a buffer overflow in trans2open (CVE-2003-0201) we can exploit this by using Metasploit to create a reverse shell. If successfully exploited we will be able to obtain root access.</p>
<p><strong>Tool:</strong> Metasploit</p>
<p><strong>Reference:</strong> <a href="https://github.com/security-cheatsheet/metasploit-cheat-sheet">Metasploit Cheat</a></p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image7.png" /></p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image8.png" /></p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image9.png" /></p>
<h2 id="apache-exploit">Apache Exploit</h2>
<p>Apache 1.3.20 suffers from a buffer overflow vulnerability due to Apache-SSL improperly handling memory during the <code>i2d_SSL_SESSION</code> function call. This allows for remote code execution if the attacker utilizes a very large client certificate if it is signed by a trusted Certificate Authority. We can find C source code on GitHub which we can then clone, compile it and run against our target machine to obtain a root shell.</p>
<p><strong>Resource:</strong> <a href="https://github.com/heltonWernik/OpenLuck?tab=readme-ov-file">GitHub Exploit - OpenLuck</a></p>
<p><img alt="image.png" src="../../../images/APatchTooLate/image10.png" /></p>
<h1 id="conclusion">Conclusion</h1>
<p><strong>Root Cause:</strong> Outdated Samba and Apache Services</p>
<p><strong>Result:</strong> Successful root shell via Metasploit and compiled C program</p>
<p><strong>Lessons Learned:</strong> Importance of patching legacy services and securing default shares.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>